\documentclass[lettersize,journal]{IEEEtran}
\usepackage{amsmath,amsfonts}
\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{array}
\usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
\usepackage{textcomp}
\usepackage{stfloats}
\usepackage{url}
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{cite}
\usepackage{overpic}
\usepackage{xcolor}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=blue,      
    urlcolor=blue,
    citecolor=black,
    pdftitle={Overleaf Example},
    pdfpagemode=FullScreen,
    }
    
\usepackage[normalem]{ulem}
\hyphenation{op-tical net-works semi-conduc-tor IEEE-Xplore}
% updated with editorial comments 8/9/2021
\input{scidefs}

\usepackage{amssymb}

\let\oldemptyset\emptyset
\let\emptyset\varnothing

\begin{document}

\title{Limitations of Wave Field Synthesis Part II:\\low-frequency limits}

\author{Gergely Firtha
\thanks{Manuscript received April 19, 2021; revised August 16, 2021.}}


% The paper headers
\markboth{Journal of \LaTeX\ Class Files,~Vol.~14, No.~8, August~2021}%
{Shell \MakeLowercase{\textit{et al.}}: A Sample Article Using IEEEtran.cls for IEEE Journals}

\IEEEpubid{0000--0000/00\$00.00~\copyright~2021 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.

\maketitle

\begin{abstract}
\end{abstract}


\begin{IEEEkeywords}
Article submission, IEEE, IEEEtran, journal, \LaTeX, paper, template, typesetting.
\end{IEEEkeywords}

\section{Introduction}

Wave Field Synthesis (WFS) is an advanced spatial audio rendering technique capable of accurately synthesizing sound fields by employing a dense array of secondary loudspeakers distributed along a contour or surface, known as the secondary source distribution (SSD).

Originally introduced by Berkhout in the late 1980s \cite{Berkhout1988, doi:10.1121/1.404755, Berkhout1993:Acoustic_control_by_WFS}, WFS utilizes the Huygens–Fresnel principle to reconstruct intended acoustic wavefronts over an extended listening area. Over subsequent decades, significant theoretical advancements have refined its mathematical framework \cite{Vogel1993:phd, Start1997:phd, Verheijen1997:phd, Sonke1998}, expanded its scope to include innovative virtual source paradigms such as focused and moving sources \cite{Spors2009focused, Wierstorf2013focused, Oldfield2013_FocusedWFS, Ahrens2008moving, doi:10.1121/1.4996126}, and systematically addressed various implementation constraints.

Despite these advances, WFS inherently possesses limitations, particularly at the lower end of its operational frequency range. The integral representations used—specifically the Kirchhoff approximation and the Rayleigh integral—are fundamentally high-frequency approximations. Consequently, low-frequency performance deteriorates below a geometry-dependent threshold \cite{Spors10ahrens:analysis}. Although this phenomenon is acknowledged within the literature, a comprehensive analytical treatment and rigorous understanding of the precise low-frequency limits remain largely unexplored.

This paper, as the second part of a two-part series, specifically addresses these gaps by rigorously examining the low-frequency behavior and limits inherent to WFS. We analyze how the intrinsic approximations influence low-frequency wavefront reproduction and derive explicit criteria and characterizations for assessing low-frequency performance. Moreover, we extend our discussion to focused sources, a case exhibiting pronounced low-frequency artifacts due to truncation and tapering effects, areas previously under-examined in existing literature.

Following the principles of reproducible research, the MATLAB code for the figures in this article is publicly accessible at \href{https://github.com/gfirtha/ieee2025b_firtha/tree/gfirtha/MATLAB}{\uline{\small{https://github.com/gfirtha/ieee2025b\_firtha/tree/gfirtha/MATLAB}}}.

\section{Theoretical basics}

\subsection{Problem formulation}
Consider an arbitrary three-dimensional sound field expressed generally in polar form as
\begin{equation}
P(\vx,\omega) = A^P(\vx) \, \te^{\ti k \phi^P(\vx)},
\label{eq:general_field}
\end{equation}
where the position vector $\vx = \posvec{3}{x}{y}{z}$ is any arbitrary point in 3D space, $k = \frac{\omega}{c}$ represents the acoustic wavenumber, and $c$ denotes the speed of sound.

Wavefronts are surfaces characterized by constant phase (isophase, or isochronous in the time domain) surfaces, given by $\phi^P = \mathrm{constant}$. 
These can be locally described up its second order Taylor's approximation by their propagation (ray) direction and curvature when viewed within an intrinsic coordinate system aligned with the ray direction:
\begin{itemize}
  \item We define the normalized local wavenumber vector as
\begin{equation}
\vhk^P(\vx) = -\nabla_{\vx} \phi^P(\vx), \hspace{5mm} |\vhk^P(\vx)| = 1,
\label{eq:eikonal}
\end{equation}
which is a unit vector oriented towards the direction of maximum phase progression, thus indicating the local direction of propagation. 
  \item The curvature of the wavefront is described by the second derivative of the phase as
\begin{equation}
\kappa^P_{1,2}(\vx) = \frac{1}{\rho^P_{1,2}(\vx)} = - \mathrm{eigs}\left( \frac{\partial^2 \phi^P(\vx)}{\partial \vx_i \partial \vx_j} \right).
\end{equation}
\end{itemize}
In polar form, the gradient of the sound field is expressed as
\begin{multline}
\nabla_{\vx} P(\vx) = P'(\vx) = \left(\frac{\nabla_{\vx} A^P(\vx)}{A^P(\vx)} + \ti k \nabla_{\vx} \phi^P(\vx) \right)P(\vx) = \\
= \left(\overline{\kappa}^P(\vx) + \ti k \right) \vhk^P(\vx) P(\vx),
\label{eq:gradient}
\end{multline}
where $\overline{\kappa}^P(\vx)$ signifies the mean curvature of the wavefront.
In the far field of the source of the sound $|\overline{\kappa}^P(\vx)| \ll k$ holds and the gradient can be approximated as
\begin{equation}
\nabla_{\vx} P(\vx) \approx  \ti k \vhk^P(\vx) P(\vx),
\label{eq:pw_appr}
\end{equation}
coined here as a local plane wave approximation, since the equation holds with equality for the case of a plane wave ($\overline{\kappa}^P(\vx) = 0$).

In sound field synthesis, the goal is to replicate this specified wavefront using a continuous array of secondary point sources arranged along a contour $C$, known as the secondary source distribution (SSD). 
These secondary sources are driven by \emph{driving functions} $D(\vxo,\omega)$, leading to the synthesized sound field:
\begin{equation}
\Psynth(\vx,\omega) = \oint_C D(\vxo, \omega) G(\vx-\vxo) \td s(\vxo).
\label{eq:synth_field}
\end{equation}
The synthesized field is intended to precisely match the target field.
Here, $G(\vx-\vxo) = \frac{1}{4\pi}\frac{\te^{-\ti k|\vx-\vxo|}}{|\vx-\vxo|}$ is the 3D free-field Green's function, describing the radiation from a secondary point source, and $s(\vxo)$ denotes the arc length along the SSD.

The contour of these secondary sources is positioned in a horizontal plane, defined at $z=0$, aligned with the listener's ear level, known as the synthesis plane. 
The associated geometry is depicted in Figure \ref{Fig:geometry}.


\begin{figure} 
  \begin{center}
    \begin{overpic}[width = 1\columnwidth ]{figs/WFS_geometry_2b.png}
	\scriptsize
	\put(61.5,40.5){$\vxo$}
	\put(44,40){$\vxref(\vxo)$}
	\put(24,35){$\vx$}
	\put(3,19){synthesis plane}
	\put(40,22){$C$: SSD contour}
	\put(8,50){$S$: integral surface}
	\put(80.5,71){reference curve}
	\put(80.5,61.5){active SSD}
	\put(56,34){$\vhk^P(\vxo)$}
	\put(84,47){$x$}
	\put(95,29){$y$}
	\put(97,58){$z$}
	\put(81,42){$\vxs$}
	%\put(72,37){$\rho^P(\vxo)$}
  \put(80,66){{\fontsize{7pt}{\baselineskip}
  \selectfont \parbox{4cm}{vertical integral\\path}  }}
	\end{overpic}
\end{center}
\caption{Geometry for deriving 2.5D Kirchhoff approximation and WFS driving functions.}
	\label{Fig:geometry}
\end{figure}

\subsection{The 3D Kirchhoff-approximation}
The starting point of WFS theory involving arbitrary SSD geometries is the simple source formulation of the target sound field inside the listening region, expressed in term of a single layer potential.
For a closed surface $\Omega$ that encloses this region one has \cite{colton1983integral,ColtonKress1998}
{\fontsize{10pt}{\baselineskip}
\selectfont
\begin{equation}
  \small
  P(\vx) = \oint_\Omega  \underbrace{\left(P'_{\mathrm{n}}(\vxo, \omega) - P'_{\mathrm{scat,n}}(\vxo, \omega)\right)}_{\mu(\vxo)} G(\vx-\vxo) \td S(\vxo).
\end{equation}} 
The term $P_{\mathrm{scat}}$ is the \emph{exterior} pressure field produced when an acoustically soft surface is placed on~$\Omega$ and excited by $P$; see \cite{Fazi2013:Equivalent_scattering}.  
The jump in the pressure gradient $\mu(\mathbf{x}_{0},\omega)$ constitutes the driving signal for the secondary sources.

In the context of WFS the surface of integration is chosen to be $\Omega$ is translationally invariant in the vertical direction; its intersection with the horizontal plane is the actual SSD contour (Fig.~\ref{Fig:geometry}). 
The integration surface is illustrated in Fig.~\ref{Fig:geometry}.
%In the kernel of the integral $P_{\mathrm{scat}}(\vxo, \omega)$ is an exterior field, scattered from a sound soft surface along $\Omega$, on which the scattered pressure is given by $P(\vxo, \omega), \vxo \in \Omega$ \cite{Fazi2013:Equivalent_scattering}. 
%In the integral $\mu(\vxo)$ represents the pressure gradient jump between the interior and exterior sound fields, yielding driving functions for the general synthesis problem.
%The equivalent scattered field is known analytically only in special (planar, spherical, etc.) geometries, while for arbitrary geometries numerical solution is required by using e.g. the Boundary Element Method.
Unfortunately, except for canonical geometries (plane, sphere, cylinder, …) $P'_{\mathrm{scat,n}}$ is not available in closed form, and numerical Boundary Element Method is required—clearly unsuitable for real-time reproduction.
%The practical applicability of the above formulation is, therefore, limited in the context of sound field reproduction.

Assuming that the integral/scatterer surface can be considered locally planar within the scale of the wavelength the scattered field can by approximated by $P'_{\mathrm{scat,n}}(\vxo, \omega) \approx -P'_{\mathrm{n}}(\vxo, \omega)$, yielding the Kirchoff approximation (KA) or tangent plane approximation of the interior sound field \cite{Pierce1991, Ogilvy1991, FelsenMarcuvitz1994, Chew1995}
{\fontsize{9pt}{\baselineskip}
\selectfont
\begin{equation}
  \small
  P(\vx) \approx \oint_\Omega 2 w(\vxo) \, P'_{\mathrm{n}}(\vxo, \omega) G(\vx-\vxo) \td S(\vxo).
  \label{eq:KA}
\end{equation}}
The window function, given by
\begin{equation}
  w(\vxo) = 
  \begin{cases}
    1  \hspace{5mm} \text{if} \hspace{1cm} \hkn^P(\vxo)\geq 0, \\
    0   \hspace{5mm} \text{otherwise}
  \end{cases}
  \label{eq:win}
\end{equation}
performs the partitioning of the integral surface to an acoustically illuminated and a shadow region.
For an infinite planar surface the above expression holds with equality, termed as the Rayleigh integral.

The Kirchhoff approximation is intrinsically a \emph{high-frequency} model: creeping waves (diffraction) and secondary reflections between different parts of~$\Omega$ are disregarded.  
The general validity of the KA is a complex, extensively researched question, however, with no general analytical formulation available, so far.
The question frequently arises in the aspect of calculating fields scattered from rough, typically non-convex surfaces, in which typically far-field assumptions are made e.g. scattering of plane waves evaluated far from the scatterer surface.
Sufficient validity conditions, normally derived for plane-wave scattering from rough or non-convex surfaces, are \cite{Franco2017,Fung1981,Eaton2006}
\begin{equation}
      2 k \hkn^{P}(\vxo) \overline{\rho}_{\Omega}(\vxo) \gg 1, \text{or} \hspace{5mm} 2 k \hkn^{P}(\vxo)^3 \overline{\rho}_{\mathrm{\Omega}}(\vxo) \gg 1
  \end{equation}
with $\overline{\rho}_{\Omega}$ being the mean local radius of the integral surface.
In the present treatise, however, we are interested about its validity for smooth integral surfaces, but with both the sound source and receiver positions typically located in the proximity of the SSD.
In this scenario it will be shown that the low frequency limit of applicability is mainly dominated by the size of the integral surface (SSD) and the structure of the integral's amplitude distribution ($\mu(\vxo)$).

From the integral formulation \eqref{eq:KA} the 3D WFS driving functions could be directly extraced, allowing the synthesis of the target field applying an enclosing SSD surface.
In order to arrive at driving functions for an SSD contour the following asymptotic approximation is applied to the 3D KA.

\subsection{The Stationary Phase Approximation}

Consider a Fourier-type contour integral in the form
\begin{equation}
  I(k) = \oint_C A(s) \te^{\ti k \phi(s)} \td s
  \label{eq:SPA_int}
\end{equation}
being a generalization of the boundary integrals given by the Kirchhoff approximation, or the synthesized field.
The integral can be evaluated around \emph{critical points} in the integral path: around discontinuities, interpreted as the source of unintended diffractional waves and around stationary positions describing the intended field in a ray acoustic manner \cite{Firtha2025_ieee_a}.
In the present contribution we are interested only this latter contribution, with the asymptotic evaluation termed as the stationary phase approximation (SPA)

The SPA relies on the idea that under high frequency conditions rapid oscillations may cancel out and the integral is dominated by stationary positions in the integral path where the phase does not change.
Mathematically, the stationary positions are found where the phase gradient vanishes.
In the geometry relevant to the present work the surface integrals separate into products of one-dimensional integrals; hence it suffices to treat the 1-D case, for which the stationary position is found where
\begin{equation}
  \phi'(s^{\ast}) \;=\; 0, 
  \qquad
  \phi''(s^{\ast})\neq 0
  \label{eq:stationary_point}
\end{equation}
holds.

The derivation of the SPA relies on the Taylor's expansion of both the phase and the amplitude function, performing analytical Gaussian integration termwise and collecting same powers of $k$ together to rewrite the original integral as a power series of $k$ in the form
\begin{equation}
  I(k) = \sum_{i = 0}^{\infty} \frac{I_i(k)}{  \left(\ti k |\Phi^{''}(s^*)|\right)^{i}}
  \label{eq:SPA_series}
\end{equation}
The leading order (geometrical-optics) term is referred to as the stationary phase approximation of the integral, given by 
{\fontsize{10pt}{\baselineskip}
\selectfont
\begin{equation}
    I_0(k) \sim % = \sum_{i = 0}^{\infty} \frac{I_i}{\left( k |\Phi^{''}(s^*)| \right)^{i+0.5}} \sim \\
  A(s^*) \te^{\ti k \Phi(s^*)} \sqrt{\frac{2\pi}{k |\Phi^{''}(s^*)|}} \te^{\ti \frac{\pi}{4}\mathrm{sign}(\Phi^{''}(s^*))},
  \label{eq:SPA0}
\end{equation}}
with $\sim$ denoting equality at $k \rightarrow \infty$.


%{\fontsize{9pt}{\baselineskip}
%\selectfont
%\begin{multline}
%  I_0(k) \sim % = \sum_{i = 0}^{\infty} \frac{I_i}{\left( k |\Phi^{''}(s^*)| \right)^{i+0.5}} \sim \\
%  \overbrace{A(s^*) \te^{\ti k \Phi(s^*)} \sqrt{\frac{2\pi}{k |\Phi^{''}(s^*)|}} \te^{\ti \frac{\pi}{4}\mathrm{sign}(\Phi^{''}(s^*))}}^{I_0} \cdot \\ \cdot \left(1 + \frac{I_1}{\ti k |\Phi^{''}(s^*)|} +  \frac{I_2}{ ( \ti  k |\Phi^{''}(s^*)|)^2} + ... +  \frac{I_i}{ (\ti  k |\Phi^{''}(s^*)|)^i}  \right)
%  \label{eq:fullSPA}
%\end{multline}}
%As an example, the first non-leading term is given by
%\begin{equation}
%  \footnotesize
%  I_1 = 
%  \frac{1}{2}\frac{A^{''}(s^*)}{A(s^*)} - \frac{ \frac{1}{8}  \Phi^{(4)}(s^*) + \frac{1}{2} \Phi^{'''}(s^*)A'(s^*)/A(s^*)}{\Phi^{''}(s^*)} + \frac{\frac{5}{24} \Phi^{'''}(s^*)^2 }{\Phi^{''}(s^*)^2},
%\end{equation}
%and where each term $I_i$ can be written as a further power series of $\frac{1}{\Phi^{''}(s^*)}$.
%The leading term $I_0$ is the usual form of the stationary phase approximation of the integral, emerging from the Taylor's approximation of the ampltideu and phase up to the leading and the second order respectively.
%Thus, the integral of the function is approximated by its stationary value along with a curvature correction term.

%The low frequency validity of the above approximation is of central importance of the present contribution, and will be discussed in the following sections when the formula is applied to integral formulations of sound fields. 

\subsection{The 2.5D Kirchhoff-approximation}
The geometry for the Kirchhoff approximation (Eq.~\ref{eq:KA}) is shown in \ref{Fig:geometry}, with the window function \eqref{eq:win} denoted by pale red surface.
Due to the vertical invariancy the integral can be split to a vertical and a horizontal integral ($\int_\Omega ... \td S(\vxo) = \int_{C} \int_{-\infty}^{\infty} ... \td z_0 \td s(x_0,y_0)$).
In WFS theory the SPA is first applied to the Kirchhoff approximation along the vertical dimension in order to reduce the surface integral to a contour integral along the physically realizable SSD contour.

The stationary position for the surface integral is found where the gradient of the integrand's phase function vanishes, i.e. where $\vhk^P(\vxo^*) = \vhk^G(\vx-\vxo^*)$ holds (the local propagation direction of the Green's function is aligned with that of the virtual field along the SSD).
Thererfore, for virtual fields located in the the synthesis plane with $\hat{k}^P_z = 0$ the vertical stationary position is identically found at $z^* = 0$ as it is illustrated in Figure \ref{Fig:geometry}.

The required vertical second phase derivative is given by $\phi^{P+G''}_{zz}  =  -\left( \frac{1}{\rho^G(\vx-\vxo)} + \frac{1}{\rho^P_v(\vxo)} \right)$, with $\rho^P_v$ and $\rho^G$ being the vertical radii of the target field and the Green's function (the latter given identically by $\rho^G(\vx-\vxo) = |\vx-\vxo|$).
The above quantity frequently emerges in the following, therefore, for the sake of brevity we define the \emph{vertical/horizontal amplitude correction factor} as
\begin{equation}
  d^{\mathrm{c}}_{v/h}(\vx,\vxo)
    = \frac{\rho^{P}_{v/h}(\vxo) \rho^{G}(\vx- \vxo)}{\rho^{P}_{v/h}(\vxo) + \rho^{G}(\vx- \vxo)}.
\end{equation}

Approximating \eqref{eq:KA} by the leading order SPA given by Eq.~\eqref{eq:SPA0} results in the contour integral
{\fontsize{8pt}{\baselineskip}
\selectfont
\begin{multline}
  P(\vx,\omega) = \oint_C w(\vxo) \sqrt{\frac{8\pi}{\ti k}} 
  \sqrt{d^{\mathrm{c}}_{v}(\vx,\vxo)}
  P'_{\mathrm{n}}(\vxo, \omega)  G(\vx-\vxo,\omega)\td s(\vxo)
  \label{eq:25D_KA}
\end{multline}}
referred to as the 2.5D Kirchhoff approximation.
Finally, the local plane wave approximation for the target field's gradient given by Eq.~\ref{eq:pw_appr}, a choice justified in the following section, resulting in the final form
{\fontsize{9pt}{\baselineskip}
\selectfont
\begin{multline}
  P(\vx,\omega)  \oint_C  w(\vxo)  \hkn^P(\vxo) \, \sqrt{8\pi \ti k} \, \sqrt{d^{\mathrm{c}}_{v}(\vx,\vxo)}\cdot
  \\ P(\vxo, \omega)  G(\vx-\vxo,\omega)\, \td s(\vxo).
  \label{eq:25D_KA}
\end{multline}}

The above 2.5D integral formulation can be further evaluated asymptotically with decomposing it to an intended component and additional diffractional waves due to the finite horizontal integral path.
The intended field can be estimated by the horizontal SPA around the integral's stationary points $\vxo^*(\vx)$ that has to be found for each evaluation position $\vx$ (For the sake of brevity this dependency is not denoted in the following), resulting in
{\fontsize{8pt}{\baselineskip}
\selectfont
\begin{multline}
  P(\vx,\omega) \sim 
  4\pi w(\vxo^*) \, \sqrt{d^{\mathrm{c}}_{v}\left(\vx,\vxo^*\right)}   \sqrt{d^{\mathrm{c}}_{h}\left(\vx,\vxo^*\right)}
    P(\vxo^*, \omega) G(\vx-\vxo^*).
   \label{eq:25D_KA_amp_dist} 
\end{multline}}
The above formulation can be shown to coincide the target field under the validity of the SPA \cite{Firtha2025_ieee_a}.
This fact already shows that the validity of the 2.5D Kirchhoff approximation and the SPA are strongly interconnected: as long the SPA holds the KA inherently holds (asides from the undesired diffractional waves).

Furthermore, from \eqref{eq:WFS_amp_dist} the role of the amplitude correction factor is apparent:
In the frequency range where ray theory and the SPA holds, the amplitude distribution of the acoustic field is governed by the geometric spreading of energy, which is inherently defined by the phase function of the field, encoded in the wavefront curvature (as it is reflected by Eq.~(4) \cite{Firtha2025_ieee_a}).
Once the amplitude of the field is known at the stationary position and 3D propagation is assumed the amplitude is matched to the intended by the amplitude correction factor.

\subsection{The 2.5D WFS driving functions}
The 2.5D WFS driving function for an arbitrary SSD contour can be extracted from the 2.5D KA \eqref{eq:25D_KA} by making the kernel of the integral independent of the receiver position $\vx$, apparent in $d^{\mathrm{c}}_{h}\left(\vx,\vxo^*\right)$.
This is achieved by realizing that under the validity of the above mentioned further, horizontal SPA each SSD element at $\vxo$ dominates the synthesized field at those receiver positions for which the SSD element serves as a horizontal stationary position. 
This allows one to assign a unique reference position to each SSD position denoted by $\vxref(\vxo)$ as shown in Fig.~\ref{Fig:geometry} (hence dependencies $\vx(\vxo^*)$ interchanged to $\vxo(\vxref)$).
The set of all reference positions define the reference curve along which amplitude correct synthesis can be achieved. 
With these considerations the 2.5D WFS driving functions are given as 
{\fontsize{9pt}{\baselineskip}
\selectfont
\begin{multline}
  D(\vxo,\omega) = w(\vxo) \, \sqrt{\frac{8\pi} {\ti k}} \,  \sqrt{d^{\mathrm{c}}_{v}\left(\vxref(\vxo),\vxo\right)} \,  P'_{\mathrm{n}}(\vxo, \omega) \approx\\
  \approx w(\vxo)  \, \sqrt{8\pi \ti k} \, \sqrt{ d^{\mathrm{c}}_{v}\left(\vxref(\vxo),\vxo\right) } \,  \hkn^P(\vxo)\, P(\vxo, \omega).
  \label{eq:25D_WFS}
\end{multline}}
and similarly to \eqref{eq:25D_KA_amp_dist} the intended component of the synthesized field is given as
{\fontsize{8pt}{\baselineskip}
\selectfont
\begin{multline}
  \Psynth(\vx,\omega) \sim 
  4\pi w(\vxo^*) \\ \sqrt{ d^{\mathrm{c}}_{v}\left(\vxref(\vxo^*),\vxo^*\right)} \sqrt{ d^{\mathrm{c}}_{h}\left(\vx,\vxo^*\right)}
    P(\vxo^*, \omega) G(\vx-\vxo^*).
% =\\ =
%    w(\vxo^*)
%    \sqrt{\frac{ \rho^G(\vxref(\vxo^*)-\vxo^*) }{ \rho^P_v(\vxref(\vxo^*))} 
%    \frac{ \rho^P_v(\vx)}{ \rho^G(\vx-\vxo^*) } }
 %   P(\vx,\omega).
   \label{eq:WFS_amp_dist} 
\end{multline}}
The above formulation trivially matches the target field at $\vx = \vxref$.
Again, it is emphasized the dependency $\vxo^*(\vx)$ is suppressed, but in order to evaluate the above formulation for a given receiver position the stationary SSD element has to be found a-priori as shown in Fig.~\ref{Fig:geometry}.

\section{Low frequency limits of WFS}

\begin{figure}[!t]
  \centering
  % LEFT COLUMN
  \begin{minipage}{0.49\columnwidth}
    \begin{overpic}[width=\linewidth]{figs/Fig_2_a.png}
      \footnotesize\put(0,2){(a)}
    \end{overpic}
  \end{minipage}
  \hfill
  % RIGHT COLUMN
  \begin{minipage}{0.49\columnwidth}
    \begin{minipage}{1\columnwidth}
      \begin{overpic}[width=\linewidth]{figs/Fig_2_b.png}
      \footnotesize\put(0,2){(b)}
    \end{overpic}
  \end{minipage}
    \vspace{0.1cm} % small vertical gap
    
    \begin{minipage}{1\columnwidth}
    \begin{overpic}[width=\linewidth]{figs/Fig_2_c.png}
      \footnotesize\put(0,2){(c)}
    \end{overpic}
  \end{minipage}
\end{minipage}

  \caption{Evaluation of a point source's field by the 2.5D appoximation at $f_0 = 1~\mathrm{kHz}$ (a), and the measured normalized frequency response at the origin by applying the 3D (b) and the 2.5D Kirchhoff approximation.
  On Figure (a) white filled area denotes the amplitude distribution of the 2.5D integrand.}
  \label{fig:Kirchhoff_appr}
\end{figure}

The main goal of the present contribution is to define a lower cutoff frequency above which WFS theory holds.
The previous section already highlighted that in the geometry under discussion---i.e.~for sources and receivers located typically in the SSD's proximity ---this frequency coincides with the validity of the stationary phase approximation.

The validty of the stationary phase approximation is a complex problem that would require the careful investigation of the phase and amplitude relations of the entire integral path~\cite{chassande-mottin_flandrin_1999, 721375}.
A local approximation on the low frequency limit can be given by investigating the KA's integrand's amplitude and phase changes around the stationary position, as discussed in~\cite{firtha_hahn_schultz_fiala_2025} and briefly outlined in the appendix~\ref{app:local_SPA}.
This local approach, however, does not take the finite size of the SSD into account, which is shown to dominate in the aspect of WFS.

In the following a physically motivated approach is introduced, which takes into account finite size SSDs, however, does not investigate the relative rate of amplitude and phase changes in the integration path.
Therefore, the following approach is mainly applicable for smooth, enclosing SSDs, being a realistic requirement for WFS applications.
It should be noted that the following discussion both hold in the context of WFS and more generally for the 2.5D Kirchhoff approximation, therefore, they are discussed adjointly.

\subsection{Qualitative analysis}
For a qualitative analysis of the underlying principles, first the example of the 3D and 2.5D WFS is investigated, reproducing a point source inside a circular area, as illustrated in Fig.~\ref{fig:Kirchhoff_appr}.
Fig.~(a) illustrates the synthesized pressure and the approximate solution of the equivalent scattering problem in the exterior domain.
Figures (b) and (c) depict the measured frequency response at the center of the circular SSD.
In order to investigate the structure of the synthesized field the gradient decomposition of the the target field given by Eq.~\eqref{eq:gradient} is applied to both the 3D and 2.5D WFS integrals allowing to partition them into a nearfield and farfield contribution.
Written for the 2.5D case this yiels 
{\fontsize{8pt}{\baselineskip}
\selectfont
\begin{multline}
  \Psynth(\vx,\omega)  = \oint_C w(\vxo) \, \sqrt{\frac{8\pi} {\ti k}} \, \sqrt{ d^{\mathrm{c}}_{v}\left(\vxref(\vxo),\vxo\right)} \left( \overline{\kappa}^P(\vxo) + \ti k\right) \cdot \\ \cdot 
  \, P(\vxo, \omega) G(\vx-\vxo,\omega) \td s(\vxo) 
  = I_{\mathrm{near}}(\vx,\omega) + I_{\mathrm{far}}(\vx,\omega) 
\end{multline}}
with
{\fontsize{9pt}{\baselineskip}
\selectfont
\begin{multline}
  I_{\mathrm{near}}(\vx,\omega) = \sqrt{\frac{8\pi}{\ti k}}\, \oint_C \overline{\kappa}^P(\vxo) w(\vxo)  \hkn^P(\vxo)   \, \sqrt{d^{\mathrm{c}}_{v}\left(\vxref(\vxo),\vxo\right)} \cdot
  \\ P(\vxo, \omega)  G(\vx-\vxo,\omega)\, \td s(\vxo), 
\end{multline}}
\vspace{-0.7cm}
{\fontsize{9pt}{\baselineskip}
\selectfont
\begin{multline}
  I_{\mathrm{far}}(\vx,\omega)  =  \sqrt{8\pi \ti k} \oint_C  w(\vxo)  \hkn^P(\vxo)  \,d^{\mathrm{c}}_{v}\left(\vxref(\vxo),\vxo\right) \cdot
  \\ P(\vxo, \omega)  G(\vx-\vxo,\omega)\, \td s(\vxo).
  \label{eq:Ifar}
\end{multline}}
and a similar decomposition can be written for the 3D case.
In Fig.~\ref{fig:Kirchhoff_appr} (b) and (c) all the results are normalized by the target field's nominal amplitude at the measurement position.

The amplitude distribution of the integrand in \eqref{eq:Ifar} is illustrated in Fig.~\ref{fig:Kirchhoff_appr} (a) over the SSD with white area.
It is important to realize that even in case of an infinite planar/linear integration path the amplitude distribution decays rapidly towards the lateral integration positions, therefore, the amplitude distribution acts as a windowing function with an effective length defined in the following section.% \footnote{Similar effective aperture sizes can be defined for the 3D case as well. For the 3D case, however, the problem is more complex as in the present separable geometry a vertical and horizontal effective length can be defined and the behaviour of the integrals change at two cutoff frequencies, depending on these lengthes. 
%This aspect is, however, out of the scope of the present discussion.}.
The contribution of $I_{\mathrm{near}}$ and $I_{\mathrm{far}}$ depend on how the phase function $\phi^P(\vxo) + \phi^G(\vx-\vxo)$ changes within this effective window length.
\begin{itemize}
  \item For low frequencies the phase barely changes over the effective window length, therefore, the integrand is approximately constant in phase over the SSD.
  As a result, for the 3D case the nearfield contribution is constant, while the farfield contribution exhibits a frequency response of $~\sim \ti k$.
  The constant nearfield contribution also shows a level decrease which is the error of the Kirchhoff approximation, highlighting that the KA is inherently unable to predict the target field's evanescent contribution/reactive near field.
  Obivously, this error vanishes in case of a planar integration path.
  \item For high frequencies the phase changes significantly within the effective window length. 
  As the SPA starts to hold rapid oscillations cancel out and the nearfield contribution decreases with $~\sim \ti k$ while the farfield contribution is constant.
  \item In case of the 2.5D WFS the SPA introduces a frequency correction factor of $~\sim \sqrt{1/\ti k}$.
  For low frequencies, where the SPA does not hold this results in an erroneous low frequency boost for the near field given by $~\sim \sqrt{1 /\ti k}$, and results in an overall frequency response of $~\sim \sqrt{\ti k}$ for the farfield component.
  On the other hand when the SPA requirements is fulfilled $I_{\mathrm{far}}(\vx,\omega)$ exhibits the correct flat frequency response.
  This observation justifies the application of the high frequency gradient approximation in the 2.5D KA and 2.5D WFS theory.
\end{itemize}
From the above discussion it is clear that our aim is to find the amount of phase increment within the effective window length to find the low frequency limit of the 2.5D Kirchhoff approximation, and consequently of Wave Field Synthesis.

\subsection{Relation of the SPA validity and Fresnel zone theory}

As a most simple approach the cutoff frequency can be directly estimated from the graph of the synthesized field's frequency response, as shown in Fig.~\ref{fig:Kirchhoff_appr} (b), restricting our investigation to the farfield component $I_{\mathrm{far}}$.
From herein let's denote the amplitude of the integrand in \eqref{eq:Ifar}, including the amplitude of the driving function and the SSD to receiver Green's function by 
{\fontsize{9pt}{\baselineskip}
\selectfont
\begin{multline}
 A^{D\cdot P}(\vx,\vxo) = \\
 \underbrace{w(\vxo)  \hkn^P(\vxo) \, \sqrt{8\pi} \, \sqrt{d^{\mathrm{c}}_{v}\left(\vxref(\vxo),\vxo\right)} \, A^P(\vxo)}_{A^{D}(\vxo)}  A^G(\vx-\vxo).
\end{multline}}
It is known, that below the unknown cutoff wavenumber $k_{c}$ the slope of the synthesized field decreases by 10 dB/decade, i.e. with $\sim \sqrt{k}$.
The endpoint of the slope at $k = 0$ is given by 
\begin{equation} 
I_{\mathrm{far}}(\vx, 0) = \oint_C A^{D\cdot P}(\vx,\vxo) \, \td s(\vxo).
\end{equation} 
On the other hand applying piecewise linear approximation to the Bode plot the synthesized field reaches it's target level at $\omega_c = c \cdot k_c$, with the ideal amplitude given analytically by Eq.~\eqref{eq:WFS_amp_dist}, therefore,
\begin{multline} 
I_{\mathrm{far}}(\vx, \omega_{c}) = 4\pi w(\vxo^*) \, \sqrt{d^{\mathrm{c}}_{v}\left(\vxref(\vxo^*),\vxo^*\right)} \sqrt{d^{\mathrm{c}}_{h}\left(\vx,\vxo^*\right)} \cdot \\ \cdot 
    A^P(\vxo^*) A^G(\vx-\vxo^*)
\end{multline} 
holds.
From these considerations the cutoff frequency can be simply estimated as
\begin{equation}
  \small
 \sqrt{k_c(\vx)} I_{\mathrm{far}}(\vx, 0)  = I_{\mathrm{far}}(\vx, \omega_{c}) 
\hspace{2mm} \rightarrow \hspace{2mm}
  k_c(\vx) = \left(\frac{I_{\mathrm{far}}(\vx, \omega_{c})}{I_{\mathrm{far}}(\vx, 0)}\right)^2.
\label{eq:omega_c}
\end{equation}

The above formulation already allows one to estimate the lower cutoff frequency of 2.5D WFS (and of the 2.5D KA) by simple  geometrical considerations, however, it gives an accurate result only for frontal/on-axis positions (i.e. in front of a virtual sound source towards the center of the SSD) as it will be highlighted in later sections.
In order to arrive at a more general, physically motivated result it is investigated how the phase function of the integrand changes along the SSD at the critical cutoff frequency given by Eq.~\eqref{eq:omega_c}.

\begin{figure} 
  \begin{center}
    \begin{overpic}[width = 0.7\columnwidth  ]{figs/effective_window_simple_geom.png}
    \footnotesize
    \put(80.5,39){$\vxo^*(\vx)$}
    \put(38,39){$\vxref(\vxo^*)$}
    \put(22,39){$\vx$}
    \put(95,30){$\vk^{\mathrm{PW}}$}  
    \put(75,57){\textcolor[RGB]{162,50,52}{$\Leff$}}  
    \scriptsize \put(68,28){\rotatebox{90}{ \textcolor[RGB]{107,107,107}{ $A^{D\cdot P}(s)$} } }  
    %\put(29,37){$\vx = \vxref(\vxo^*)$}
	\end{overpic}
\end{center}
\caption{Symmetrical geometry for estimating the phase increment towards the SSD endpoints at the cutoff frequency in case of an incident plane wave with the wave vector $\vk^{\mathrm{PW}}$.
The ampltidue distribution $A^{D\cdot P}(\vx,\vxo)$ is denoted by white filled area, while the symmetrical equivalent window is denoted by red fill.}
	\label{Fig:Leff_simplified_geometry}
\end{figure}


As an initial geometry consider the symmetric case depicted in Fig.~\ref{Fig:Leff_simplified_geometry}, the same as used for Fig.~\ref{fig:Kirchhoff_appr}.
The SSD is chosen to be a circular (albeit potentially arbitrary symmetric) one.
It is assumed that both the virtual source and the receiver lie sufficiently far from the integral path/SSD, thus the amplitude does not change over it significantly, allowing to employ a leading order Taylor's approximation.
Yet, we allow the normal component of the local wavenumber vector and the tapering window to change considerably as they both vanish towards the SSD endpoints.
With these assumptions the endpoint of the slope at $k = 0$ is approximated as  
\begin{multline} 
I_{\mathrm{far}}(\vx, 0) \approx \sqrt{8\pi}  
\sqrt{d^{\mathrm{c}}_{v}\left(\vxref(\vxo^*),\vxo^*\right)}
  \\ A^P(\vxo^*)\,  A^G(\vx-\vxo^*) \,\underbrace{\oint_C  w(\vxo) \,  \hkn^P(\vxo^*) \td s(\vxo)}_{2\Leff}.
  \label{eq:Ifar_appr}
\end{multline} 
with $\Leff$ being an equivalent, effective window length.
It is noted here that for the case of an incident plane wave and fixing the receiver to the center of the array the above expression holds with equality.
By substituting the above approximation to \eqref{eq:omega_c} cutoff wavenumber then can be approximated in the present setup by
%{\fontsize{7pt}{\baselineskip}
%\selectfont
%\begin{multline} 
%\omega_c(\vx) = 
%\frac{
 % 4\pi \sqrt{\frac{ \rho^P_v(\vxo^*) \, \rho^G(\vxref-\vxo^*) }{ \rho^P_v(\vxo^*) + \rho^G(\vxref-\vxo^*)} } 
%  \sqrt{\frac{\rho^P_h(\vxo^*) \, \rho^G(\vx-\vxo^*)}{  \rho^P_h(\vxo) + \rho^G(\vx-\vxo^*)}}
%   A^P(\vxo^*, \omega) A^G(\vx-\vxo^*) }{
%    \sqrt{8\pi} \sqrt{\frac{ \rho^P_v(\vxo^*) \, \rho^G(\vxref-\vxo^*) }{ \rho^P_v(\vxo^*) + \rho^G(\vxref-\vxo^*)} } 
%  A^P(\vxo^*)  A^G(\vx-\vxo^*) \Leff(\vx)
%   }
%\label{eq:omega_c_appr}
%\end{multline}}
{\fontsize{10pt}{\baselineskip}
\selectfont
\begin{equation} 
k_c(\vx) \approx
 \frac{\pi}{2} 
 \frac{ d^{\mathrm{c}}_{h}\left(\vx,\vxo^*\right) }{ 
   \Leff^2
 }.
\label{eq:omega_c_appr}
\end{equation}}

In Appendix \ref{app:phase_increment} the phase increment from the stationary point to an arbitrary arc length is given by \eqref{eq:phase_inc}, reading as
{\fontsize{9pt}{\baselineskip}
\selectfont
\begin{equation} 
 \Delta \phi^{P+G}(\Delta s) =
- \frac{ \Delta s ^2}{2} \frac{\hkn^P(\vxo^*)^2}{d^{\mathrm{c}}_{h}\left(\vx,\vxo^*\right) }.
\end{equation}}
This allows one to express the total phase change up to the end of the equivalent window  $\Delta s = \Leff $ on the cutoff wavenumber $k_c$, which in the present frontal case ($\hkn^P(\vxo^*)=1$) given by
{\fontsize{8pt}{\baselineskip}
\selectfont
\begin{equation} 
 k_c(\vx)\Delta \phi^{P+G}(\Leff) = -\frac{\pi}{4}.
\end{equation}}
This result is fundemantel in the aspect of the present treatise: it states that in frontal directions the SPA starts to hold when the phase increment from the center of the array exceeds $\pi/4$ towards the end of the effective endpoint of the SSD, or with other word the entire effective window length contains at least a half wavelength.

The result is in perfect agreement with the theory of Fresnel zones and Fresnel numbers: Eq.~\eqref{eq:omega_c_appr} can be reaaranged to
 {\fontsize{10pt}{\baselineskip}
\selectfont
\begin{equation} 
F = \frac{\Leff^2}{\lambda_c(\vx) d^{\mathrm{c}}_{h}\left(\vx,\vxo^*\right)} 
=0.25
\end{equation}}
which is clearly the Fresnel number, generalized to an 1D aperture with a complex amplitude distribution:
the role of the aperture radius is taken by the equivalent, effective window length, while the receiver to aperture distance is now given by the amplitude correction factor, which serves as an effective distance. 
For the special case of a plane wave ($\rho^P_{\mathrm{h/v}} = \infty$) $d^{\mathrm{c}}_{h}\left(\vx,\vxo^*\right) = \rho^G(\vx-\vx^*)$ holds which gives the classic Fresnel number definition.
Also in accordance with Fresnel zone theory, with the Fresnel number of $F= 0.25$ the phase change from the center of the array to the end of the effective length is $\pi/4$, i.e. $\frac{\lambda}{8}$. 

Overall, it is stated that the SPA starts to hold once the overall phase increment within the effective window exceeds $\pi / 2$.
The connection of the SPA's validity condition and the Fresnel zone theory has been already reported in the literature in the topic of 2.5D Kirchhoff migration \cite{Hertweck2003}, where it is stated that integration over only the first Fresnel zone already provides a very good approximation of the total 2.5D Kirchhoff integral, however does not take the role of the effective aperture length (i.e. the apparent shortening of the aperture) into consideration, which explains the apparently looser condition, introduced here.


\subsection{General low frequency validity condition for 2.5D WFS}
In the following we generalize the previous results in order to give low frequency validity conditions for 2.5D WFS for arbitrary source models and receiver positions.

\begin{figure} 
  \begin{center}
    \begin{overpic}[width = 0.8\columnwidth]{figs/effective_window_geom.png}
	\footnotesize
    \put(48,11.5){$\vxo^*(\vx)$}
    \put(25,27){$\vxref(\vxo^*)$}
    \put(28,39){$\vx$}
    \put(52,3.5){\rotatebox{20}{ \textcolor[RGB]{162,50,52}{$\hat{L}_{\mathrm{eff},1}$}}  }
    \put(67,9){\rotatebox{21}{ \textcolor[RGB]{162,50,52}{$\hat{L}_{\mathrm{eff},2}$}}  }
    \scriptsize \put(60,18){\rotatebox{15}{ \textcolor[RGB]{107,107,107}{ $A^{D\cdot P}(s)$} } }  
  \put(35,50){$\mathfrak{I}$}
    \put(20,16){$\mathfrak{T}_1$}
  \put(85,40){$\mathfrak{T}_2$}
  \put(30,8.5){$\mathfrak{S}_1$}
  \put(90,29){$\mathfrak{S}_2$}
    \put(56,57){$C: s(\vxo)$}
	\end{overpic}
\end{center}
\caption{Arbitrary geometry for estimating the low frequency cutoff for 2.5D WFS.
The ampltidue distribution $A^{D\cdot P}(\vx,\vxo)$ is denoted by white filled area, while the symmetrical equivalent window is denoted by red fill.
$\mathfrak{I}$ denotes the illuminated region, $\mathfrak{S}_i$ the shadow and $\mathfrak{T}_i$ the tapering regions \cite{Firtha2025_ieee_a}.}
	\label{Fig:Leff_geometry}
\end{figure}

The role of the effective window length has already emerged naturally in \eqref{eq:Ifar_appr}, taking only in consideration amplitude variations due to tapering and changes in the local wavenumber vector.
Naturally, the amplitude variations due to the target field's amplitude and the Green's function also act as a windowing function, decaying towards the SSD endpoints.
Furthermore, non-central stationary positions should be taken into consideration in order to account for arbitrary SSD shapes and lateral receiver positions.
As a further generalization let's define the effective window length measured from the stationary position towards both end of the SSD.
The effective lengthes are calculated from the amplitude distribution of the integrand, normalized by its stationary value, given by
 {\fontsize{10pt}{\baselineskip}
\selectfont
\begin{equation}
\hat{L}_{\mathrm{eff},1/2}(\vx) = \int_{\vxo^*(\vx)}^{\vx_{1/2}} \frac{  A^{D\cdot P}(\vx,\vxo) }{A^{D\cdot P}(\vx,\vxo^*(\vx))} \td s(\vxo),
\label{eq:Leff}
\end{equation}}
where $A^{D\cdot P}$ is the amplitude of the integrand describing the synthesized field, i.e. the product of the driving function's and the Green's function's amplitude
 {\fontsize{8pt}{\baselineskip}
\selectfont 
\begin{equation}
A^{D\cdot P}(\vx,\vxo) = w(\vxo)  \hkn^P(\vxo) \,\sqrt{d^{\mathrm{c}}_{v}\left(\vxref(\vxo),\vxo\right)}  A^P(\vxo)  A^G(\vx-\vxo).
\end{equation}}
In order the SPA to hold we may require that the integrand's phase should exceed $\pi / 4$ in both effective window lengthes, i.e. two critical wavenumbers are given by 
\begin{equation}
  k_{c,1/2}(\vx) \cdot \, \Delta \phi(\hat{L}_{\mathrm{eff},1/2}(\vx)) = -\frac{\pi}{4}.
\end{equation}
Finally, by using \eqref{eq:phase_inc} for the phase increment the critical wavenumbers and the corresponding critical frequencies are given as
\begin{equation}
  \small
  k_{c,1/2}(\vx) = \frac{\pi}{2} \frac{ d^{\mathrm{c}}_{h}(\vx,\vxo^*)}{
   \hat{L}_{\mathrm{eff},1/2}(\vx) ^2 \hat{k}_{\mathrm{n}}(\vxo^*)^2  }
  \label{eq:low_freq_limit}
\end{equation}
and $f_{c, 1/2}(\vx) = \frac{k_c(\vx) \, c}{2 \pi}$, being the main result of the present contribution.
The above cutoff frequency is obviously a generalization of \eqref{eq:omega_c_appr}, extended towards arbitrary integrand amplitude and lateral source/receiver positions.
The expression states that the frequency band of synthesis is maximal for frontal positions $(\hat{k}_{\mathrm{n}}(\vxo^*)) = 1$, and for sources and receivers far from the SSD. 
However it may dramatically decrease once either the source or the receiver gets to the SSD proximity.
Furthermore, the lower cutoff frequency scales inversely proportionally with the second power of the SSD's effective length.
This effective length is dominated by the SSD's physical dimensions, but is also affected by the source and receiver positions (again, sources or receivers in the proximmity of the SSD significantly shorten the effective length) and can be significantly altered by applying tapering or unsuitable referencing scheme.

As a brief summary, on order to calculate the low frequency limit of 2.5D WFS in a practical scenario one has to define the stationary position for a given receiver position by simple geometric means.
Having found the stationary position the equivalent/effective window length has to be calculated on both sides of the stationary point, requiring the numerical integration of the driving function (multiplied by the Green's function).
From the effective window length the lower cutoff frequencies can be calculated analytically by \eqref{eq:low_freq_limit}, from which, obviously, the higher frequency limit gives the overall cutoff frequency (defined from the shorter window length).

\section{Application examples}

\subsection{Cutoff frequency for simple WFS geometries}
Next the application of the previous results is investigated in simple practical WFS scenarios: in case of the syntehsis of a point source and a plane wave by using linear and circular SSDs.

\paragraph{Cutoff frequency for a virtual point source}
For the case of a virtual   point source located at $\vxs = \posvec{3}{x_s}{y_s}{0}$ the principle radii and the local wavenumber vector specializes to $\rho^P_{\mathrm{v/h}}(\vx) = |\vx-\vxs|$, $\vk^P(\vx) = \frac{\vx-\vxs}{|\vx-\vxs|}$.
The amplitude of the integrand describing the synthesized field is given by
\begin{multline}
A^{D\cdot P}(\vx,\vxo) = w(\vxo) \, \sqrt{\frac{ |\vxref(\vxo)-\vxo| }{F\,|\vxref(\vxo)-\vxo| + |\vxo - \vxs|}}  \cdot
 \\  \frac{\left<\vxo-\vxs \cdot \mathbf{n}(\vxo) \right>}{|\vxo-\vxs|^{3/2}}  \frac{1}{|\vx-\vxo|},
\end{multline}
where $F$ is a focused flag, accounting for the synthesis of focused point sources as described in \cite{Firtha2025_ieee_a}.
Once the reference curve is defined the effective lengthes can be calculated from the above amoplitude distribution according to \eqref{eq:Leff}.
In order to evaluate the low frequency limit at $\vx$ one has to find the corresponding stationary SSD element $\vxo^*(\vx)$, which is simply given by the intersection of the SSD and the line connecting the virtual source and the receiver position, as shown e.g. in Fig~\ref{Fig:Psynth_linear}.
Finally, the low frequency limit can be calculated as
\begin{equation}
  \small
  k_{c,1/2}^{\mathrm{PS}}(\vx) = \frac{\pi}{2} 
  \frac{|\vx-\vxo^*|\,|\vxo^* - \vxs| }{F |\vx-\vxo^*| + |\vxo^* - \vxs|}
  \frac{1}{
   \hat{L}_{\mathrm{eff},1/2}(\vx) ^2 \hat{k}_{\mathrm{n}}(\vxo^*)^2  }.
  \label{eq:low_freq_limit_PS}
\end{equation}


\begin{figure} 
  \begin{center}
    \begin{overpic}[width = 1\columnwidth]{figs/Psynth_linear_ps.png}
            \scriptsize \put(0,10){(a)}
            \scriptsize \put(58,0){(b)}
	\end{overpic}
\end{center}
\caption{Synthesis of a point source by using a finite linear SSD segment with the total length of 3~m.
Figure (a) depicts the synthesized field along with the investigation setup 
Figure (b) shows the frequency response in the frontal ($\vx_{\mathrm{r}_1} = \posvec{2}{0}{1}~\mathrm{m}$) and an examplery lateral ($\vx_{\mathrm{r}_1} = \posvec{2}{1.5}{1}~\mathrm{m}$) receiver position, both chosen to lie on the reference line in the present example, with highlighting the estimated lower cutoff frequencies.}
	\label{Fig:Psynth_linear}
\end{figure}

\paragraph{Cutoff frequency for a virtual plane wave}
For the special case of a virtual plane wave, propagating towards the direction $\vk^{\mathrm{PW}}$ for the principle radii $\rho^P_{\mathrm{v/h}}(\vx) =\infty$ holds, and the integrand amplitude is given by
 {\fontsize{8pt}{\baselineskip}
\selectfont 
\begin{equation}
A^{D\cdot P}(\vx,\vxo) = w(\vxo) \left< \vk^{\mathrm{PW}} \cdot \mathbf{n}(\vxo)\right>\,  \frac{\sqrt{|\vxref(\vxo)-\vxo|}}{|\vx-\vxo|}.
\end{equation}}
The stationary SSD element $\vxo^*(\vx)$ is found from the intersection of the SSD and the line with the direction $\vk^{\mathrm{PW}}$ passing through $\vx$ (illustrated in in Fig~\ref{Fig:Psynth_circular}), allowing the calculation of the cut off frequency
\begin{equation}
  \small
  k_{c,1/2}^{\mathrm{PW}}(\vx) = \frac{\pi}{2} 
  \frac{|\vx-\vxo^*|}{
   \hat{L}_{\mathrm{eff},1/2}(\vx) ^2 \hat{k}_{\mathrm{n}}(\vxo^*)^2  }.
  \label{eq:low_freq_limit_PS}
\end{equation}

\paragraph{Application with linear and circular SSD}
Figure \ref{Fig:Psynth_linear} presents the case of synthesis of a point source applying a linear SSD along $y = 0$. 
The reference curve is chosen to be a reference line, parallel to the SSD at $y = \yref$.
This setup is usually termed as traditional WFS, being the geometry for which WFS theory was first formulated \cite{Berkhout1988}.
In this geometry from simple triangle similarities $\frac{|\vxref(\vxo)-\vxo| }{|\vxref(\vxo)-\vxo| + |\vxo - \vxs|} = \frac{\yref}{\yref - \ys}$ holds for the virtual point source case.

Figure \ref{Fig:Psynth_circular} presents the case of synthesis applying a circular SSD centered at the origin with the radius $\Rssd = 2~\mathrm{m}$. 
Figure (a), (b) and (c) show the synthesis of a plane wave, a point source and the special case of a focused point source respectively.
In each case as a simplest---yet widely used---referencing scheme, the reference distance is fixed to $\vxref(\vxo) = \Rssd$.
This results in a reference curve varying with the virtual source model (as described in \cite{Firtha2016, Firtha2025_ieee_a}) in each case passing through the center of the array. 
  
\begin{figure} 
  \begin{center}
    \begin{overpic}[width = 1\columnwidth ]{figs/Psynth_circular_pw.png}
      \scriptsize \put(0,0){(a)}
      \scriptsize \put(45,0){(b)}
	\end{overpic}
 \\ \vspace{5mm}
    \begin{overpic}[width = 1\columnwidth ]{figs/Psynth_circular_ps.png}
      \scriptsize \put(0,0){(c)}
      \scriptsize \put(45,0){(d)}
	\end{overpic}
 \\ \vspace{5mm}
    \begin{overpic}[width = 1\columnwidth ]{figs/Psynth_circular_fps.png}
      \scriptsize \put(0,0){(e)}
      \scriptsize \put(45,0){(f)}
	\end{overpic}
\end{center}
\caption{Synthesis of a plane wave (a-b), an unfocused point source at $\vxs = \posvec{2}{3}{0}~\mathrm{m}$ (c-d) and a focused point source at at $\vxs = \posvec{2}{1}{0}~\mathrm{m}$ (e-f) by using a circular SSD with $\Rssd = 2~\mathrm{m}$.
Figure (a,c,e) depicts the synthesized field along with the investigation setup 
Figure (b,d,f) shows the frequency response in the frontal ($\vx_{\mathrm{r}_1} = \posvec{2}{0}{0}~\mathrm{m}$) and an examplery lateral ($\vx_{\mathrm{r}_1} = \posvec{2}{0}{1.5}~\mathrm{m}$) receiver position, both chosen to lie on the reference line in the present example, with highlighting the estimated lower cutoff frequencies.}
	\label{Fig:Psynth_circular}
\end{figure}

In each case the frequency response of the synthesized field along with the estimated low frequency limits are illustrated in the frontal direction and in an examplary lateral direction.
The frequency response is normalized by it's ideal high frequency value, given by \eqref{eq:WFS_amp_dist}.
The amplitude of the integrands are illustrated by white fill along the SSD contour for the lateral direction example.
The resulting effective lengthes around the stationary position are denoted by a red contour along the SSD.

It is reflected that in the present examples of symmetrical SSDs for the frontal position the effective lengthes, and, therefore, the two cutoff frequencies coincide.
In both linear and circular SSD cases independently of the virtual source model the estimated low frequency limit is perfectly aligned with the apparent $0~\mathrm{dB}$ cut off frequencies of the simulated responses.
On the other hand for the lateral responses highlight the role of the two estimated cutoff frequencies:
Below $\min f_{c,1/2}$ the SPA does not hold at all: the frequency response changes with $\sim \sqrt{\omega}$, i.e. with $+10~\mathrm{dB/dec}$.
Above $\max f_{c,1/2}$ the phase change exceeds $\pi/4$ on both sides of the stationary point, therefore, the SPA holds, and the frequency response sets to its asymptotic high frequency value along with the diffractional waves.
This frequency range is the validity range of 2.5D WFS theory.
Between the two cutoff frequencies the phase changes enough only on one side of the stationary position (with the longer effective length).
Subsequently, the integrand value can not be considered constant anymore, but the lobes of rapid oscillations does not cancel each other yet.
This results in a transition frequency band with the slope of around $+5~\mathrm{dB/dec}$, but the actual response varies heavily, depending on the actual WFS geometry.

\subsection{Cutoff frequency as function of source and receiver position}

In the following the overall low frequency limit is investigated as the function of source position and receiver position.
The low frequency limit is calculated as the higher one from $f_{c,1/2}$.

Fig.~\ref{Fig:fc_spat_dist_linear} (a-b) depicts the spatial variancy of the low frequency limit of WFS with varying receiver position with a fixed virtual source model chosen to be a virtual plane wave and a point source respectively by applying a finite linear SSD.
Similary, Fig.~\ref{Fig:fc_spat_dist_circular} (a-c) depict the same quantity in case of a circular SSD with the further example of a focused point source.
\begin{figure} 
  \begin{center}
    \begin{overpic}[width = 0.44\columnwidth ]{figs/Fc2_lin_vs_recpos_pw.png}
	\scriptsize
	\put(0,0){(a)}
	\end{overpic}
  \hfill
    \begin{overpic}[width = 0.53\columnwidth ]{figs/Fc2_lin_vs_recpos_ps.png}
	\scriptsize
	\put(0,0){(b)}
	\end{overpic}
  \\ \vspace{2mm}
%%
  \begin{overpic}[width = 0.44\columnwidth ]{figs/Fc2_lin_vs_sourcepos.png}
	\scriptsize
	\put(0,0){(c)}
	\end{overpic}
  \hfill
    \begin{overpic}[width = 0.51\columnwidth ]{figs/Fc2_lin_vs_sourcepos_cross.png}
	\scriptsize
	\put(0,0){(d)}
	\end{overpic}
\end{center}
\caption{Lower frequency limit of 2.5D WFS as the function of receiver position (a-b) and virtual source position (c-d) in case of synthesis applying a linear SSD segment.
Figure (a) and (b) shows the cutoff frequency vs. receiver position in case of a virtual plane wave and an unfocused point source respectively.
Figure (c) shows the cutoff frequency as function of virtual source position, while (d) shows the same quantity along the frontal position ($x=0$, as denoted by dashed line in (c)) with varying SSD length.
All the simulations were ran with a Hann window tapering with tapering coefficient of 0.25.}
	\label{Fig:fc_spat_dist_linear}
\end{figure}
From the simulation results it is apparent that the lower frequency limit of WFS is maximal in frontal positions and degrade rapidly into lateral directions: even within the illuminated region the lower frequency limit may exceed $1~\mathrm{kHz}$.
Below this cutoff frequency---between the transition of the two cutoff frequencies derived in the previous section---the frequency response slightly decreases within the range of $4-5~\mathrm{dB}$, as it can be observed in Figs.~\ref{Fig:Psynth_linear} and \ref{Fig:Psynth_circular} with approximately $-5~\mathrm{dB/decade}$.
This loss of low frequencies is, however, can be still clearly audible, potentially leading to a coloration in the low frequency region.
Below the minimal cutoff frequency (which coincides with the maximal one into frontal directions) the frequency response decreases with $-20~\mathrm{dB/decade}$ leading to enhanced loss of low frequency response.

\begin{figure} 
  \begin{center}
    \begin{overpic}[width = 0.3\columnwidth ]{figs/Fc_circ_pw.png}
	\scriptsize
	\put(0,0){(a)}
	\end{overpic}
%
    \begin{overpic}[width = 0.3\columnwidth ]{figs/Fc_circ_ps.png}
	\scriptsize
	\put(0,0){(b)}
	\end{overpic}
%
    \begin{overpic}[width = 0.36\columnwidth ]{figs/Fc_circ_fps.png}
	\scriptsize
	\put(0,0){(c)}
	\end{overpic}
  \\ \vspace{2mm}
  %
    \begin{overpic}[width = 0.3\columnwidth ]{figs/Fc2_circ.png}
	\scriptsize
	\put(0,0){(d)}
	\end{overpic}
  \hfill
    \begin{overpic}[width = 0.6\columnwidth ]{figs/Fc2_circ_crosssec.png}
	\scriptsize
	\put(0,0){(e)}
	\end{overpic}
\end{center}
\caption{Lower frequency limit of 2.5D WFS as the function of receiver position (a-c) and virtual source position (d-e) in case of synthesis applying a circular SSD.
Figure (a), (b) and (c) shows the cutoff frequency vs. receiver position in case of a virtual plane wave, an unfocused point source and a focused point source respectively.
Figure (d) shows the cutoff frequency as function of virtual source position, while (e) shows the same quantity along the frontal position ($y=0$), as denoted by dashed line in (d) with varying SSD length.
Figure (e) depicts the cutoff frequency using a tapering window coefficient of 0.25 with solid, and 0.5 with a dashed line.
}
	\label{Fig:fc_spat_dist_circular}
\end{figure}

As a more important aspect on investigation in the aspect of synthesizing dynamically changing sound fields (e.g. field of a moving source) Fig.~\ref{Fig:fc_spat_dist_linear} (c-d) and Fig.~\ref{Fig:fc_spat_dist_circular} (d-e) depict the spatial dependency of the lower cutoff frequency as the function of virtual source position applying a linear and a circular SSD respectively.
For the linear case the receiver position is fixed to the frontal position, while for the circular case it is fixed to the center of the array.
Obivously, for the circular case the lower cutoff frequency is rotationally invariant around the center due to the synthesis geometry (being an inherent advantage of the circular SSD geometry).
On the other hand, similarly to changes in the receiver position, the lower cutoff frequency increase rapidly towards lateral directions.
This 

In both cases, the freuqency limit rises 





\section{Conclusion}

\appendix[A local SPA validity criterion]
\label{app:local_SPA}
As a simple local validity condition for the SPA it may be required that the leading order term should dominate over the second one in the integral's expansion around the stationary poisition.
From \eqref{eq:SPA_series} this condition can be expressed as
\begin{equation}
  |I_0(k)| \geq \left| \frac{I_1(k)}{  \ti k |\Phi^{''}(s^*)|} \right|.
\end{equation}
The amplitude of the second term in the expansion can be given by \cite{Firtha2025_daga, torresani2000analyse}
{\fontsize{8pt}{\baselineskip}
\selectfont
\begin{multline}
  I_1(k) = 
  I_0(k) \left(\frac{1}{2}\frac{A^{''}(s^*)}{A(s^*)}  \right. - \\ \left. -  \frac{ \frac{1}{8}  \Phi^{(4)}(s^*) + \frac{1}{2} \Phi^{'''}(s^*)A'(s^*)/A(s^*)}{\Phi^{''}(s^*)} + \frac{\frac{5}{24} \Phi^{'''}(s^*)^2 }{\Phi^{''}(s^*)^2} \right).
\end{multline}}
yielding the condition
\begin{equation}
  \scriptsize
  k \geq \frac{A^{''}(s^*)}{2A(s^*)|\Phi^{''}(s^*)|}  -  \frac{ \frac{1}{4}  \Phi^{(4)}(s^*) +  \Phi^{'''}(s^*)A'(s^*)/A(s^*)}{2\Phi^{''}(s^*)^2} + \frac{\frac{5}{24} \Phi^{'''}(s^*)^2 }{\Phi^{''}(s^*)^3}.
\end{equation}

The above criterion gives a local approximation of the SPA's low frequency validity merely by investigating the relative amplitude and phase changes around the stationary position.
As an example, for frontal positions odd derivatives cancel out and the condition simplifies to
\begin{equation}
  \small
  k \geq \frac{1}{2}\frac{A^{''}(s^*)}{A(s^*)|\Phi^{''}(s^*)|}  -  \frac{1}{8} \frac{  \Phi^{(4)}(s^*)}{\Phi^{''}(s^*)^2}.
\end{equation}
Here, the first term dominates the right side for virtual sources and receivers located in the proximity of the SSD and simply states that in order the SPA to hold the wavefront curvature should be larger than the amplitude function's curvature, in order to the oscillation cancel out around the stationary position.

This local condition may be advantageous when the integration (SSD) length is much larger than source and receiver distances and the amplitude may change rapidly aloung the contour, e.g. in case of scattering from rough surfaces of large (infinite) extent.
But since the involved functions are investigated around the stationary position, therefore, the physical size of the SSD is not taken into consideration, dominating in case of practical WFS geometries.

\appendix[Phase increment to arbitrary arc length]
\label{app:phase_increment}

Our aim is to estimate the phase increment along the SSD contour from the stationary position $\vxo^*$ (or $\vxo(s^*)$) up to an arbitrary arc length increment $\Delta s$.
As a first step the phase function can be expanded into a Taylor's series around the stationary point $\vxo^*$, reading 
{\fontsize{8pt}{\baselineskip}
\selectfont
\begin{equation}
  \phi^{P+G}(s) \approx \phi^{P+G}(s^*) + \left( s-s^* \right)\phi^{'P+G}_s(s^*) + \frac{\left( s-s^* \right)^2}{2}\phi^{''P+G}_{ss}(s^*)
  \label{eq:phase_taylors}
\end{equation}}
Note that for the sake of brevity notation $\vxo(s)$ is suppressed.
The phase increment than is expressed as  
{\fontsize{9pt}{\baselineskip}
\selectfont
\begin{multline} 
  \Delta \phi^{P+G}(\Delta s) =  \phi^{P+G}(s^* + \Delta s ) - \phi^{P+G}(s^*) = \\ =
   \Delta s \, \phi^{'P+G}_s(s^*) + \frac{ \Delta s^2}{2}\phi^{''P+G}_{ss}(s^*).
  \label{eq:phase_increment}
\end{multline}}

The first derivative $\phi^{'P+G}_s(s^*)$ read as
{\fontsize{8pt}{\baselineskip}
\selectfont
\begin{multline}
  \phi^{'P+G}_s(\vxo(s)) = \frac{\partial }{\partial s}\phi^{P+G}(\vxo(s)) = \\ =\nabla_{\vx}\phi^{P+G}(\vxo(s)) \cdot \frac{\partial \vxo(s)}{\partial s}
  = \hks^P(\vxo) - \hks^G(\vx- \vxo)
   \label{eq:first_deriv}
\end{multline}}
where $\frac{\partial \vxo(s)}{s}$ is the tangential vector of the SSD assuming an arc length parametrization.
For the second derivative the derivation is given in Appendix A of \cite{Firtha2025_ieee_a}, with the final result being
\begin{multline}
  \phi^{P+G''}_{ss}(\vxo(s)) = 
   -\hat{k}_{\mathrm{n}}(\vxo)^2 \left(\frac{1}{\rho^G_h(\vx-\vxo)} + \frac{1}{\rho^P_h(\vxo)} \right) - \\
   -2 \left( \hat{k}^P_{\mathrm{s}}(\vxo) - \hat{k}^G_{\mathrm{s}}(\vx-\vxo)\right) \kappa_{\mathrm{SSD}}(\vxo),
   \label{eq:curvature_horiz}
\end{multline}
where $\kappa_{\mathrm{SSD}}$ is the local curvature of the SSD.
By definition, in the stationary position $\hat{k}^P_{\mathrm{s}}(\vxo) = \hat{k}^G_{\mathrm{s}}(\vx-\vxo)$ holds, simplifying both \eqref{eq:first_deriv} and \eqref{eq:curvature_horiz} as
\begin{align}
   \phi^{'P+G}_s(\vxo(s^*)) &= 0,\\
    \phi^{P+G''}_{ss}(\vxo(s^*)) &= -\hat{k}_{\mathrm{n}}(\vxo)^2 \left(\frac{1}{\rho^G_h(\vx-\vxo)} + \frac{1}{\rho^P_h(\vxo)} \right) 
\end{align}
Finally, the required phase increment is given from \eqref{eq:phase_increment} by
{\fontsize{9pt}{\baselineskip}
\selectfont
\begin{multline} 
 \Delta \phi^{P+G}(\Delta s) = \frac{ \Delta s ^2}{2}\phi^{''P+G}_{ss}(s^*) = \\ =
- \frac{ \Delta s ^2}{2} \hat{k}_{\mathrm{n}}(\vxo^*)^2 \left(\frac{1}{\rho^G_h(\vx-\vxo^*)} + \frac{1}{\rho^P_h(\vxo^*)} \right).
\label{eq:phase_inc}
\end{multline}}

\section*{Acknowledgments}
This work was supported by the János Bolyai Research Scholarship of the Hungarian Academy of Science and by the OTKA PD-143129 and OTKA K-143436 grants.

%\input{pi_per_four_derivs}
%\paragraph{Arbitrary virtual source}
\bibliographystyle{IEEEtran}
\bibliography{dissertation}

\end{document}


